<!-- Grafana Business Text Plugin Compatible Dashboard -->
<!-- Performance Dashboard - Agent & Vendor Analytics -->

<style>
/* Grafana-compatible styles */
.grafana-dashboard {
    font-family: 'Roboto', 'Helvetica Neue', Arial, sans-serif;
    background: transparent;
    color: #202226;
    font-size: 14px;
    line-height: 1.4;
    margin: 0;
    padding: 16px;
}

/* Clean color palette for Grafana */
.dashboard-colors {
    --primary: #1f77b4;
    --success: #2ca02c;
    --warning: #ff7f0e;
    --error: #d62728;
    --text-primary: #202226;
    --text-secondary: #6c757d;
    --border: #e0e0e0;
    --bg-light: #f8f9fa;
    --shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Header section */
.dashboard-header {
    background: linear-gradient(135deg, var(--primary), #1565c0);
    color: white;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    text-align: center;
}

.dashboard-title {
    font-size: 24px;
    font-weight: 600;
    margin: 0 0 8px 0;
}

.dashboard-subtitle {
    font-size: 14px;
    opacity: 0.9;
    margin: 0;
}

.header-stats {
    display: flex;
    justify-content: space-around;
    margin-top: 16px;
    gap: 20px;
}

.header-stat {
    text-align: center;
    background: rgba(255,255,255,0.15);
    padding: 12px 16px;
    border-radius: 6px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.2);
    flex: 1;
}

.header-stat-value {
    display: block;
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 4px;
}

.header-stat-label {
    font-size: 12px;
    opacity: 0.9;
}

/* Alert section */
.alert-section {
    background: linear-gradient(135deg, var(--error), #e57373);
    color: white;
    padding: 16px 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 12px;
}

.alert-icon {
    font-size: 18px;
    background: rgba(255,255,255,0.2);
    padding: 8px;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.alert-content {
    flex: 1;
}

.alert-title {
    font-weight: 600;
    margin-bottom: 4px;
}

/* KPI Grid */
.kpi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
}

.kpi-card {
    background: white;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 20px;
    transition: box-shadow 0.2s ease;
    position: relative;
}

.kpi-card:hover {
    box-shadow: var(--shadow);
}

.kpi-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    border-radius: 8px 8px 0 0;
}

.kpi-card.error::before { background: var(--error); }
.kpi-card.warning::before { background: var(--warning); }
.kpi-card.success::before { background: var(--success); }
.kpi-card.info::before { background: var(--primary); }

.kpi-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 16px;
}

.kpi-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.kpi-icon {
    width: 36px;
    height: 36px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 16px;
    font-weight: 600;
}

.kpi-icon.error { background: var(--error); }
.kpi-icon.warning { background: var(--warning); }
.kpi-icon.success { background: var(--success); }
.kpi-icon.info { background: var(--primary); }

.kpi-value {
    font-size: 28px;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 8px;
}

.kpi-unit {
    font-size: 16px;
    font-weight: 500;
    color: var(--text-secondary);
    margin-left: 4px;
}

.kpi-trend {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
}

.kpi-trend.up {
    background: rgba(44, 160, 44, 0.1);
    color: var(--success);
}

.kpi-trend.down {
    background: rgba(214, 39, 40, 0.1);
    color: var(--error);
}

.kpi-trend.neutral {
    background: var(--bg-light);
    color: var(--text-secondary);
}

/* Chart placeholders */
.chart-section {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 20px;
    margin-bottom: 24px;
}

.chart-card {
    background: white;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 20px;
}

.chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
}

.chart-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
}

.chart-controls {
    display: flex;
    gap: 8px;
}

.chart-control {
    padding: 6px 12px;
    border: 1px solid var(--border);
    border-radius: 4px;
    background: white;
    color: var(--text-secondary);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.chart-control:hover,
.chart-control.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.chart-placeholder {
    height: 200px;
    background: var(--bg-light);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary);
    font-size: 14px;
    border: 2px dashed var(--border);
}

/* Data table */
.table-section {
    background: white;
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 24px;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
}

.data-table th {
    background: var(--bg-light);
    padding: 12px 16px;
    text-align: left;
    font-weight: 600;
    color: var(--text-primary);
    border-bottom: 1px solid var(--border);
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.data-table td {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    color: var(--text-primary);
}

.data-table tr:hover {
    background: var(--bg-light);
}

.data-table tr:last-child td {
    border-bottom: none;
}

.status-badge {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-badge.active {
    background: rgba(44, 160, 44, 0.1);
    color: var(--success);
}

.status-badge.warning {
    background: rgba(255, 127, 14, 0.1);
    color: var(--warning);
}

.status-badge.critical {
    background: rgba(214, 39, 40, 0.1);
    color: var(--error);
}

/* Footer */
.dashboard-footer {
    background: var(--bg-light);
    padding: 16px 20px;
    border-radius: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 12px;
    color: var(--text-secondary);
    border: 1px solid var(--border);
}

.footer-links {
    display: flex;
    gap: 16px;
}

.footer-links a {
    color: var(--text-secondary);
    text-decoration: none;
    transition: color 0.2s ease;
}

.footer-links a:hover {
    color: var(--primary);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .grafana-dashboard {
        padding: 12px;
    }
    
    .header-stats {
        flex-direction: column;
        gap: 12px;
    }
    
    .kpi-grid {
        grid-template-columns: 1fr;
    }
    
    .chart-section {
        grid-template-columns: 1fr;
    }
    
    .dashboard-footer {
        flex-direction: column;
        gap: 12px;
        text-align: center;
    }
}

/* Grafana dark theme compatibility */
@media (prefers-color-scheme: dark) {
    .grafana-dashboard {
        color: #ffffff;
    }
    
    .kpi-card,
    .chart-card,
    .table-section {
        background: #181b1f;
        border-color: #2f3349;
    }
    
    .data-table th {
        background: #2f3349;
        color: #ffffff;
    }
    
    .data-table td {
        color: #ffffff;
        border-color: #2f3349;
    }
    
    .data-table tr:hover {
        background: #2f3349;
    }
    
    .chart-placeholder {
        background: #2f3349;
        border-color: #404357;
        color: #8e8e8e;
    }
    
    .chart-control {
        background: #2f3349;
        border-color: #404357;
        color: #ffffff;
    }
    
    .dashboard-footer {
        background: #2f3349;
        border-color: #404357;
        color: #8e8e8e;
    }
}
</style>

<!-- Dashboard Content -->
<div class="grafana-dashboard dashboard-colors">
    <!-- Header Section -->
    <div class="dashboard-header">
        <h1 class="dashboard-title">Performance Dashboard</h1>
        <p class="dashboard-subtitle">Agent & Vendor Analytics</p>
        
        <div class="header-stats">
            <div class="header-stat">
                <span class="header-stat-value">205</span>
                <span class="header-stat-label">Total Agents</span>
            </div>
            <div class="header-stat">
                <span class="header-stat-value">5</span>
                <span class="header-stat-label">Active Vendors</span>
            </div>
            <div class="header-stat">
                <span class="header-stat-value">99.2%</span>
                <span class="header-stat-label">System Uptime</span>
            </div>
        </div>
    </div>

    <!-- Alert Section -->
    <div class="alert-section">
        <div class="alert-icon">‚ö†Ô∏è</div>
        <div class="alert-content">
            <div class="alert-title">Critical Alert</div>
            <div>23.7% of agents experiencing issues. 41 out of 205 agents affected by disconnected or degraded calls.</div>
        </div>
    </div>

    <!-- KPI Cards Section -->
    <div class="kpi-grid">
        <div class="kpi-card error">
            <div class="kpi-header">
                <div class="kpi-title">Disconnected Calls</div>
                <div class="kpi-icon error">üìû</div>
            </div>
            <div class="kpi-value">640<span class="kpi-unit">calls</span></div>
            <div class="kpi-trend down">‚Üó +5.2% vs yesterday</div>
        </div>

        <div class="kpi-card warning">
            <div class="kpi-header">
                <div class="kpi-title">Degraded Calls</div>
                <div class="kpi-icon warning">‚ö†Ô∏è</div>
            </div>
            <div class="kpi-value">557<span class="kpi-unit">calls</span></div>
            <div class="kpi-trend up">‚Üò -2.1% vs yesterday</div>
        </div>

        <div class="kpi-card success">
            <div class="kpi-header">
                <div class="kpi-title">Quality Score</div>
                <div class="kpi-icon success">‚≠ê</div>
            </div>
            <div class="kpi-value">91.2<span class="kpi-unit">%</span></div>
            <div class="kpi-trend neutral">‚Üí +0.3% vs yesterday</div>
        </div>

        <div class="kpi-card info">
            <div class="kpi-header">
                <div class="kpi-title">Impacted Agents</div>
                <div class="kpi-icon info">üë•</div>
            </div>
            <div class="kpi-value">41<span class="kpi-unit">agents</span></div>
            <div class="kpi-trend down">‚Üó +8.1% vs yesterday</div>
        </div>
    </div>

    <!-- Charts Section -->
    <div class="chart-section">
        <div class="chart-card">
            <div class="chart-header">
                <h3 class="chart-title">Call Quality Trends</h3>
                <div class="chart-controls">
                    <button class="chart-control active">24H</button>
                    <button class="chart-control">7D</button>
                    <button class="chart-control">30D</button>
                </div>
            </div>
            <div class="chart-placeholder">
                üìä Call Quality Trends Chart<br>
                <small>Connect to Grafana time series panel</small>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3 class="chart-title">Agent Performance</h3>
                <div class="chart-controls">
                    <button class="chart-control active">Current</button>
                    <button class="chart-control">Yesterday</button>
                    <button class="chart-control">Week Avg</button>
                </div>
            </div>
            <div class="chart-placeholder">
                ü•ß Agent Performance Distribution<br>
                <small>Connect to Grafana pie chart panel</small>
            </div>
        </div>
    </div>

    <!-- Vendor Performance Table -->
    <div class="table-section">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Vendor</th>
                    <th>Status</th>
                    <th>Total Agents</th>
                    <th>Disconnected Calls</th>
                    <th>Degraded Calls</th>
                    <th>Quality Score</th>
                    <th>Trend</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>TechSupport Pro</strong></td>
                    <td><span class="status-badge active">Active</span></td>
                    <td>45</td>
                    <td>127</td>
                    <td>89</td>
                    <td>92.4%</td>
                    <td><span class="kpi-trend up">‚Üó +0.7%</span></td>
                </tr>
                <tr>
                    <td><strong>Global Connect</strong></td>
                    <td><span class="status-badge warning">Warning</span></td>
                    <td>38</td>
                    <td>203</td>
                    <td>156</td>
                    <td>87.8%</td>
                    <td><span class="kpi-trend down">‚Üò -1.5%</span></td>
                </tr>
                <tr>
                    <td><strong>Premium Solutions</strong></td>
                    <td><span class="status-badge active">Active</span></td>
                    <td>52</td>
                    <td>89</td>
                    <td>67</td>
                    <td>95.1%</td>
                    <td><span class="kpi-trend up">‚Üó +0.2%</span></td>
                </tr>
                <tr>
                    <td><strong>Rapid Response</strong></td>
                    <td><span class="status-badge critical">Critical</span></td>
                    <td>29</td>
                    <td>145</td>
                    <td>234</td>
                    <td>83.2%</td>
                    <td><span class="kpi-trend down">‚Üò -2.2%</span></td>
                </tr>
                <tr>
                    <td><strong>Elite Support</strong></td>
                    <td><span class="status-badge active">Active</span></td>
                    <td>41</td>
                    <td>76</td>
                    <td>45</td>
                    <td>96.8%</td>
                    <td><span class="kpi-trend up">‚Üó +0.6%</span></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Footer -->
    <div class="dashboard-footer">
        <div>&copy; 2025 Performance Dashboard. Analytics Platform.</div>
        <div class="footer-links">
            <a href="#">Documentation</a>
            <a href="#">API</a>
            <a href="#">Support</a>
            <a href="#">Settings</a>
        </div>
    </div>
</div>

<!-- Grafana Variable Integration Script -->
<script>
// Grafana Business Text Plugin Compatible JavaScript
// This script handles Grafana dashboard variables and updates

// Function to update metrics with Grafana variables
function updateGrafanaMetrics() {
    // Example: Use Grafana template variables
    // Replace with actual Grafana variable syntax: ${variable_name}
    
    // Update total agents from Grafana variable
    const totalAgentsElement = document.querySelector('.header-stats .header-stat:nth-child(1) .header-stat-value');
    if (totalAgentsElement && typeof totalAgents !== 'undefined') {
        totalAgentsElement.textContent = totalAgents || '205';
    }
    
    // Update active vendors from Grafana variable
    const activeVendorsElement = document.querySelector('.header-stats .header-stat:nth-child(2) .header-stat-value');
    if (activeVendorsElement && typeof activeVendors !== 'undefined') {
        activeVendorsElement.textContent = activeVendors || '5';
    }
    
    // Update system uptime from Grafana variable
    const uptimeElement = document.querySelector('.header-stats .header-stat:nth-child(3) .header-stat-value');
    if (uptimeElement && typeof systemUptime !== 'undefined') {
        uptimeElement.textContent = systemUptime || '99.2%';
    }
    
    // Update KPI values from Grafana queries
    updateKPIValue('disconnected-calls', typeof disconnectedCalls !== 'undefined' ? disconnectedCalls : '640');
    updateKPIValue('degraded-calls', typeof degradedCalls !== 'undefined' ? degradedCalls : '557');
    updateKPIValue('quality-score', typeof qualityScore !== 'undefined' ? qualityScore : '91.2');
    updateKPIValue('impacted-agents', typeof impactedAgents !== 'undefined' ? impactedAgents : '41');
}

// Helper function to update KPI values
function updateKPIValue(kpiType, value) {
    const kpiCards = document.querySelectorAll('.kpi-card');
    kpiCards.forEach(card => {
        const title = card.querySelector('.kpi-title').textContent.toLowerCase().replace(' ', '-');
        if (title.includes(kpiType.split('-')[0])) {
            const valueElement = card.querySelector('.kpi-value');
            if (valueElement) {
                const unit = valueElement.querySelector('.kpi-unit');
                const unitText = unit ? unit.textContent : '';
                valueElement.innerHTML = value + (unit ? `<span class="kpi-unit">${unitText}</span>` : '');
            }
        }
    });
}

// Chart control functionality
function initializeChartControls() {
    document.querySelectorAll('.chart-controls').forEach(controlGroup => {
        controlGroup.addEventListener('click', function(e) {
            if (e.target.classList.contains('chart-control')) {
                // Remove active class from siblings
                controlGroup.querySelectorAll('.chart-control').forEach(ctrl => {
                    ctrl.classList.remove('active');
                });
                // Add active class to clicked control
                e.target.classList.add('active');
                
                // Trigger Grafana dashboard refresh if needed
                if (typeof window.grafanaRefresh === 'function') {
                    window.grafanaRefresh();
                }
            }
        });
    });
}

// Initialize dashboard when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    updateGrafanaMetrics();
    initializeChartControls();
    
    // Set up automatic updates if Grafana provides update events
    if (typeof window.addEventListener === 'function') {
        window.addEventListener('grafana-update', updateGrafanaMetrics);
    }
    
    // Periodic update for live data
    setInterval(updateGrafanaMetrics, 30000); // Update every 30 seconds
});

// Grafana panel resize handler
if (typeof window.addEventListener === 'function') {
    window.addEventListener('resize', function() {
        // Handle responsive adjustments
        const dashboard = document.querySelector('.grafana-dashboard');
        if (dashboard && window.innerWidth < 768) {
            dashboard.classList.add('mobile');
        } else if (dashboard) {
            dashboard.classList.remove('mobile');
        }
    });
}
</script>

<!-- Grafana Template Variables (Examples) -->
<!--
Usage in Grafana Business Text Plugin:
1. Copy the entire content above
2. Paste into Business Text plugin content
3. Replace static values with Grafana variables:
   - ${total_agents} for total agents
   - ${active_vendors} for active vendors  
   - ${system_uptime} for uptime
   - ${disconnected_calls} for disconnected calls count
   - ${degraded_calls} for degraded calls count
   - ${quality_score} for quality score
   - ${impacted_agents} for impacted agents count

4. Configure your Grafana queries to populate these variables
5. The dashboard will automatically update with live data

Example variable replacements:
- Replace '205' with ${total_agents:text}
- Replace '5' with ${active_vendors:text}  
- Replace '99.2%' with ${system_uptime:text}
- Replace '640' with ${disconnected_calls:text}
- Replace '557' with ${degraded_calls:text}
- Replace '91.2' with ${quality_score:text}
- Replace '41' with ${impacted_agents:text}
-->