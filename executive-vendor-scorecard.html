<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Vendor Scorecard Dashboard</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Calibri', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #fafbfc;
            color: #2d3748;
            line-height: 1.6;
            margin: 0;
            min-height: 100vh;
        }

        /* Main Navigation */
        .main-nav {
            background: #ffffff;
            border-bottom: 1px solid #e5e7eb;
            padding: 0 32px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            font-weight: 700;
            color: #1a202c;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: #2563eb;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 14px;
        }

        .nav-title {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: 600;
            color: #374151;
        }

        .nav-user {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 10px;
            border-radius: 6px;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            cursor: pointer;
        }

        .nav-user:hover {
            background: #f3f4f6;
        }

        .user-avatar {
            width: 28px;
            height: 28px;
            background: #2563eb;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
            font-size: 12px;
        }

        .user-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .user-name {
            font-size: 16px;
            font-weight: 600;
            color: #2d3748;
            line-height: 1.2;
        }

        .user-role {
            font-size: 13px;
            color: #2563eb;
            line-height: 1.2;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: color 0.2s ease;
        }

        .user-role:hover {
            color: #1d4ed8;
            text-decoration: underline;
        }

        .user-role-icon {
            width: 12px;
            height: 12px;
            transition: transform 0.2s ease;
        }

        .user-role:hover .user-role-icon {
            transform: translateX(2px);
        }

        /* Sub Navigation */
        .sub-nav {
            background: #ffffff;
            border-bottom: 1px solid #e5e7eb;
            padding: 0 32px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
        }

        .nav-tabs {
            display: flex;
            align-items: center;
            gap: 3px;
            background: #f3f4f6;
            padding: 3px;
            border-radius: 8px;
        }

        .nav-tab {
            padding: 6px 14px;
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            cursor: pointer;
            white-space: nowrap;
        }

        .nav-tab.active {
            background: white;
            color: #111827;
            font-weight: 700;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
        }

        .nav-tab:hover:not(.active) {
            color: #374151;
            background: rgba(255, 255, 255, 0.6);
        }



        /* Top Metrics Dock */
        .metrics-dock {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 16px;
            padding: 24px 0;
            width: 100%;
            margin-top: 16px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .metrics-container {
            display: flex;
            justify-content: center;
            align-items: stretch;
            max-width: 900px;
            margin: 0 auto;
            padding: 0 32px;
            gap: 0;
        }

        .metric-item {
            text-align: center;
            padding: 16px 32px;
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .metric-item:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 65%;
            width: 1px;
            background: #475569;
        }

        .metric-label {
            font-size: 10px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 42px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 4px;
            line-height: 1;
        }

        .metric-subtext {
            font-size: 12px;
            color: #e2e8f0;
            font-weight: 500;
            margin-bottom: 10px;
            min-height: 14px;
        }

        .metric-trends {
            display: flex;
            justify-content: center;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #f3f4f6;
            gap: 16px;
        }

        .trend-item {
            text-align: center;
        }

        .trend-label {
            font-size: 10px;
            color: #cbd5e1;
            font-weight: 600;
            margin-bottom: 2px;
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }

        .trend-value {
            font-size: 12px;
            font-weight: 700;
            color: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
        }

        .trend-up {
            color: #dc2626;
        }

        .trend-down {
            color: #16a34a;
        }

        .trend-arrow {
            font-size: 11px;
            font-weight: bold;
        }





        /* Executive Alert */
        .executive-alert {
            max-width: 900px;
            margin: 20px auto 32px;
            background: #fefefe;
            border: 1px solid #fecaca;
            border-left: 3px solid #dc2626;
            padding: 16px 24px;
            border-radius: 6px;
        }

        .alert-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }

        .alert-status {
            font-size: 10px;
            font-weight: 600;
            color: #dc2626;
            text-transform: uppercase;
            letter-spacing: 0.6px;
        }

        .alert-message {
            font-size: 13px;
            color: #374151;
            font-weight: 400;
            line-height: 1.4;
        }

        .alert-icon {
            color: #dc2626;
            width: 13px;
            height: 13px;
        }

        /* Filter Panel */
        .filter-panel {
            max-width: 900px;
            margin: 20px auto;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px 32px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .filter-container {
            display: flex;
            gap: 32px;
            align-items: center;
        }

        .filter-group {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .filter-label {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            min-width: 100px;
        }

        .filter-select-wrapper {
            position: relative;
            flex: 1;
        }

        .filter-select {
            width: 100%;
            padding: 12px 16px;
            font-size: 14px;
            font-family: Calibri, sans-serif;
            color: #1f2937;
            background: #f9fafb;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            outline: none;
            cursor: pointer;
            transition: all 0.2s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b7280' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 40px;
        }

        .filter-select:hover {
            border-color: #2563eb;
            background: #ffffff;
        }

        .filter-select:focus {
            border-color: #2563eb;
            background: #ffffff;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        /* Vendor Details Panel */
        .vendor-details-panel {
            max-width: 100%;
            margin: 20px 32px;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 24px 32px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .vendor-details-header {
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e5e7eb;
        }

        /* Table Style */
        .vendor-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }

        .vendor-table thead {
            background: #f9fafb;
        }

        .vendor-table th {
            padding: 16px 20px;
            text-align: left;
            font-size: 12px;
            font-weight: 700;
            color: #374151;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #e5e7eb;
            white-space: nowrap;
        }

        .vendor-table tbody tr {
            transition: all 0.2s ease;
            border-bottom: 1px solid #e5e7eb;
        }

        .vendor-table tbody tr:last-child {
            border-bottom: none;
        }

        .vendor-table tbody tr:hover {
            background: #f9fafb;
        }

        .vendor-table td {
            padding: 20px;
            font-size: 14px;
            color: #1f2937;
            vertical-align: middle;
        }

        .vendor-table-logo {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .vendor-table-logo-icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 700;
            color: #ffffff;
            flex-shrink: 0;
        }

        .vendor-table-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .vendor-table-name {
            font-size: 15px;
            font-weight: 700;
            color: #1f2937;
        }

        .vendor-table-category {
            font-size: 12px;
            color: #6b7280;
            font-weight: 500;
        }

        .vendor-table-metric {
            font-size: 18px;
            font-weight: 700;
            color: #1f2937;
        }

        .vendor-table-subtext {
            font-size: 11px;
            color: #9ca3af;
            font-weight: 500;
            margin-top: 3px;
        }

        .vendor-table-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 15px;
            font-weight: 700;
        }

        .vendor-table-trend.trend-up {
            color: #dc2626;
        }

        .vendor-table-trend.trend-down {
            color: #16a34a;
        }

        .vendor-table-trend.trend-neutral {
            color: #6b7280;
        }

        .vendor-table-comparison {
            font-size: 10px;
            color: #6b7280;
            font-weight: 500;
            margin-top: 3px;
        }

        /* Keep old styles for backward compatibility */
        .vendor-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .vendor-card {
            background: #fafbfc;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.2s ease;
        }

        .vendor-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border-color: #cbd5e1;
        }

        .vendor-card:last-child {
            margin-bottom: 0;
        }

        .vendor-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e5e7eb;
        }

        .vendor-logo {
            width: 44px;
            height: 44px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 700;
            color: #ffffff;
            flex-shrink: 0;
        }

        .vendor-info {
            flex: 1;
            min-width: 0;
        }

        .vendor-name {
            font-size: 15px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .vendor-category {
            font-size: 11px;
            color: #6b7280;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .vendor-metrics {
            display: flex;
            gap: 12px;
            margin-bottom: 14px;
        }

        .vendor-metric {
            background: #ffffff;
            border-radius: 6px;
            padding: 10px 12px;
            border: 1px solid #e5e7eb;
            flex: 1;
            min-width: 0;
        }

        .vendor-metric-label {
            font-size: 10px;
            color: #6b7280;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-bottom: 5px;
        }

        .vendor-metric-value {
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 3px;
        }

        .vendor-metric-subtext {
            font-size: 10px;
            color: #9ca3af;
            font-weight: 500;
            line-height: 1.3;
        }

        .vendor-trends {
            display: flex;
            gap: 12px;
            padding-top: 10px;
            border-top: 1px solid #e5e7eb;
        }

        .vendor-trend-item {
            flex: 1;
            text-align: center;
            padding: 8px;
            background: #f9fafb;
            border-radius: 6px;
        }

        .vendor-trend-label {
            font-size: 9px;
            color: #6b7280;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.4px;
            margin-bottom: 4px;
        }

        .vendor-trend-value {
            font-size: 13px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
        }

        .vendor-trend-up {
            color: #dc2626;
        }

        .vendor-trend-down {
            color: #16a34a;
        }

        .vendor-trend-neutral {
            color: #6b7280;
        }

        .trend-comparison {
            font-size: 9px;
            color: #6b7280;
            font-weight: 500;
            margin-top: 2px;
        }

        /* Trend Graphs Section */
        .trend-graphs-section {
            max-width: 100%;
            margin: 20px 32px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .trend-graph-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .trend-graph-header {
            font-size: 16px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e5e7eb;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .chart-canvas {
            width: 100%;
            height: 100%;
        }

        .legend-container {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            font-weight: 500;
            color: #6b7280;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }

        /* Footer */
        .dashboard-footer {
            background: #1e293b;
            border-top: 1px solid #334155;
            padding: 24px 32px;
            margin-top: 40px;
        }

        .footer-content {
            max-width: 100%;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .footer-copyright {
            font-size: 14px;
            color: #e2e8f0;
            font-weight: 500;
        }

        .footer-divider {
            color: #64748b;
            font-size: 14px;
        }

        .footer-support {
            font-size: 14px;
            color: #e2e8f0;
            font-weight: 500;
        }

        .footer-link {
            color: #60a5fa;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.2s ease;
        }

        .footer-link:hover {
            color: #93c5fd;
            text-decoration: underline;
        }

        /* Executive Container */
        .executive-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 32px 32px;
        }

        /* Executive Summary Cards */
        .executive-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .executive-card {
            background: white;
            border-radius: 12px;
            padding: 28px 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
            position: relative;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .executive-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }

        .critical-alert {
            border-left: 6px solid #e53e3e;
            background: #fef5f5;
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
        }

        .metric-label {
            font-size: 14px;
            font-weight: 700;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 1.2px;
        }

        .metric-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .status-critical {
            background: rgba(229, 62, 62, 0.15);
            color: #c53030;
        }

        .status-warning {
            background: rgba(237, 137, 54, 0.15);
            color: #dd6b20;
        }

        .status-good {
            background: rgba(72, 187, 120, 0.15);
            color: #38a169;
        }

        .metric-value {
            font-size: 64px;
            font-weight: 800;
            line-height: 0.9;
            margin-bottom: 16px;
            color: #2d3748;
            letter-spacing: -2px;
        }

        .metric-context {
            font-size: 16px;
            color: #718096;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .business-impact {
            font-size: 18px;
            font-weight: 700;
            padding: 16px 20px;
            border-radius: 12px;
            text-align: center;
            position: relative;
        }

        .impact-critical {
            background: rgba(229, 62, 62, 0.1);
            color: #c53030;
            border: 2px solid rgba(229, 62, 62, 0.2);
        }

        .impact-warning {
            background: rgba(237, 137, 54, 0.1);
            color: #dd6b20;
            border: 2px solid rgba(237, 137, 54, 0.2);
        }

        .impact-good {
            background: rgba(72, 187, 120, 0.1);
            color: #38a169;
            border: 2px solid rgba(72, 187, 120, 0.2);
        }

        .trend-executive {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 16px;
        }

        .trend-icon {
            font-size: 20px;
        }

        .trend-up {
            color: #e53e3e;
        }

        .trend-down {
            color: #38a169;
        }

        /* Executive Controls */
        .executive-controls {
            display: flex;
            gap: 32px;
            align-items: center;
            margin-bottom: 48px;
            background: white;
            padding: 28px 32px;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-label {
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .executive-select {
            padding: 14px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            background: white;
            min-width: 200px;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%234a5568' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 16px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 48px;
        }

        .executive-select:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 4px rgba(49, 130, 206, 0.1);
        }

        .executive-select:hover {
            border-color: #cbd5e0;
        }

        /* Vendor Performance Grid */
        .vendor-performance {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
            border: 1px solid #e2e8f0;
            margin-bottom: 48px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f7fafc;
        }

        .section-title {
            font-size: 28px;
            font-weight: 700;
            color: #1a365d;
        }

        .export-btn {
            background: #3182ce;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(66, 153, 225, 0.3);
        }

        .performance-vendor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 28px;
        }

        .performance-vendor-card {
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 28px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: #fafafa;
            position: relative;
            overflow: hidden;
        }

        .performance-vendor-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            transition: all 0.3s ease;
        }

        .performance-vendor-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.15);
            background: white;
        }

        .vendor-excellent::before {
            background: #38a169;
        }

        .vendor-attention::before {
            background: #dd6b20;
        }

        .vendor-critical::before {
            background: #e53e3e;
        }

        .performance-vendor-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .performance-vendor-name {
            font-size: 20px;
            font-weight: 700;
            color: #1a365d;
            margin-bottom: 4px;
        }

        .performance-vendor-type {
            font-size: 13px;
            color: #718096;
            font-weight: 500;
        }

        .performance-vendor-status {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .status-excellent {
            background: rgba(72, 187, 120, 0.15);
            color: #38a169;
            border: 1px solid rgba(72, 187, 120, 0.3);
        }

        .status-attention {
            background: rgba(237, 137, 54, 0.15);
            color: #dd6b20;
            border: 1px solid rgba(237, 137, 54, 0.3);
        }

        .status-critical {
            background: rgba(245, 101, 101, 0.15);
            color: #e53e3e;
            border: 1px solid rgba(245, 101, 101, 0.3);
        }

        .performance-vendor-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 24px;
        }

        .performance-vendor-metric {
            text-align: center;
        }

        .performance-vendor-metric-label {
            font-size: 12px;
            color: #718096;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .performance-vendor-metric-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .metric-excellent {
            color: #38a169;
        }

        .metric-attention {
            color: #dd6b20;
        }

        .metric-critical {
            color: #e53e3e;
        }

        .performance-vendor-trend {
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        /* Executive Actions */
        .executive-actions {
            background: #1a365d;
            border-radius: 20px;
            padding: 40px;
            color: white;
            margin-bottom: 48px;
            border: 2px solid #2c5282;
        }

        .actions-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .action-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .action-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .action-priority {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 12px;
            padding: 4px 12px;
            border-radius: 12px;
            display: inline-block;
            letter-spacing: 0.8px;
        }

        .priority-high {
            background: rgba(245, 101, 101, 0.3);
            color: #fed7d7;
        }

        .priority-medium {
            background: rgba(237, 137, 54, 0.3);
            color: #feebc8;
        }

        .action-description {
            font-size: 16px;
            font-weight: 500;
            line-height: 1.5;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .main-nav {
                padding: 0 24px;
                height: 64px;
            }

            .nav-logo {
                font-size: 20px;
                gap: 12px;
            }

            .logo-icon {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }

            .nav-title {
                display: none;
            }

            .user-info {
                display: none;
            }

            .nav-user {
                padding: 6px 12px;
                gap: 8px;
            }

            .user-avatar {
                width: 32px;
                height: 32px;
            }

            .sub-nav {
                padding: 0 24px;
                justify-content: flex-start;
            }

            .nav-tabs {
                gap: 4px;
                padding: 4px;
            }

            .nav-tab {
                padding: 8px 16px;
                font-size: 13px;
            }

            .metrics-container {
                flex-direction: column;
                padding: 0 20px;
            }

            .metric-item {
                padding: 20px 24px;
                border-bottom: 1px solid #f1f5f9;
            }

            .metric-item:not(:last-child)::after {
                display: none;
            }

            .metric-item:last-child {
                border-bottom: none;
            }

            .metric-value {
                font-size: 32px;
            }

            .executive-alert {
                margin: 24px 20px 32px;
                padding: 20px 24px;
            }

            .executive-container {
                padding: 32px 20px;
            }

            .executive-summary {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .executive-card {
                padding: 28px 24px;
                min-height: 200px;
            }

            .metric-value {
                font-size: 48px;
            }

            .executive-header {
                padding: 32px 20px;
            }

            .executive-title {
                font-size: 36px;
            }

            .executive-subtitle {
                font-size: 16px;
            }

            .executive-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 20px;
            }

            .vendor-grid {
                grid-template-columns: 1fr;
            }

            .vendor-metrics {
                grid-template-columns: 1fr;
            }

            .action-items {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .main-nav {
                padding: 0 20px;
            }

            .nav-logo {
                font-size: 18px;
                gap: 10px;
            }

            .logo-icon {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }

            .sub-nav {
                padding: 0 20px;
            }

            .nav-tab {
                padding: 8px 14px;
                font-size: 12px;
            }

            .metrics-container {
                padding: 0 16px;
            }

            .metric-item {
                padding: 16px 20px;
            }

            .executive-alert {
                margin: 20px 16px 28px;
                padding: 16px 20px;
            }

            .executive-header {
                padding: 24px 16px;
            }

            .executive-title {
                font-size: 28px;
            }

            .executive-container {
                padding: 24px 16px;
            }

            .vendor-performance {
                padding: 24px 20px;
            }

            .executive-actions {
                padding: 24px 20px;
            }

            .filter-panel {
                padding: 16px 16px;
                margin: 16px 16px;
            }

            .filter-container {
                flex-direction: column;
                gap: 16px;
            }

            .filter-label {
                min-width: 80px;
            }

            .vendor-details-panel {
                padding: 20px 16px;
                margin: 16px 16px;
                overflow-x: auto;
            }

            .vendor-table {
                font-size: 13px;
            }

            .vendor-table th,
            .vendor-table td {
                padding: 14px 12px;
            }

            .vendor-table-logo-icon {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }

            .vendor-table-name {
                font-size: 13px;
            }

            .vendor-table-category {
                font-size: 11px;
            }

            .vendor-table-metric {
                font-size: 16px;
            }

            .vendor-table-trend {
                font-size: 14px;
            }

            .vendor-grid {
                grid-template-columns: 1fr;
            }

            .vendor-metrics {
                flex-direction: column;
                gap: 12px;
            }

            .vendor-metric-value {
                font-size: 20px;
            }

            .vendor-card {
                padding: 16px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Main Navigation -->
    <nav class="main-nav">
        <div class="nav-logo">
            <div class="logo-icon">VS</div>
            <span>VendorScope</span>
        </div>
        <div class="nav-title">Executive Vendor Scorecard</div>
        <div class="nav-user">
            <div class="user-avatar">JD</div>
            <div class="user-info">
                <div class="user-name">John Doe</div>
                <a href="#" class="user-role">
                    Executive
                    <svg class="user-role-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 18l6-6-6-6"/>
                    </svg>
                </a>
            </div>
        </div>
    </nav>

    <!-- Sub Navigation -->
    <nav class="sub-nav">
        <div class="nav-tabs">
            <a href="#" class="nav-tab active">Dashboard</a>
            <a href="#" class="nav-tab">Analytics</a>
            <a href="#" class="nav-tab">Vendors</a>
            <a href="#" class="nav-tab">SLA</a>
            <a href="#" class="nav-tab">Reports</a>
            <a href="#" class="nav-tab">Settings</a>
        </div>
    </nav>

    <!-- Metrics Dock -->
    <section class="metrics-dock">
        <div class="metrics-container">
            <div class="metric-item">
                <div class="metric-label">Total Agents Impacted</div>
                <div class="metric-value">23.7%</div>
                <div class="metric-subtext">2,847 agents affected</div>
                <div class="metric-trends">
                    <div class="trend-item">
                        <div class="trend-label">DoD</div>
                        <div class="trend-value trend-up">
                            <span class="trend-arrow">↑</span>
                            +5.2%
                        </div>
                    </div>
                    <div class="trend-item">
                        <div class="trend-label">WoW</div>
                        <div class="trend-value trend-up">
                            <span class="trend-arrow">↑</span>
                            +12.1%
                        </div>
                    </div>
                    <div class="trend-item">
                        <div class="trend-label">MoM</div>
                        <div class="trend-value trend-down">
                            <span class="trend-arrow">↓</span>
                            -3.4%
                        </div>
                    </div>
                </div>
            </div>

            <div class="metric-item">
                <div class="metric-label">Total Calls Impacted</div>
                <div class="metric-value">1,847</div>
                <div class="metric-subtext">Disconnected: 350 | Degraded: 847</div>
                <div class="metric-trends">
                    <div class="trend-item">
                        <div class="trend-label">DoD</div>
                        <div class="trend-value trend-up">
                            <span class="trend-arrow">↑</span>
                            +247
                        </div>
                    </div>
                    <div class="trend-item">
                        <div class="trend-label">WoW</div>
                        <div class="trend-value trend-up">
                            <span class="trend-arrow">↑</span>
                            +892
                        </div>
                    </div>
                    <div class="trend-item">
                        <div class="trend-label">MoM</div>
                        <div class="trend-value trend-down">
                            <span class="trend-arrow">↓</span>
                            -156
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Filter Panel -->
    <section class="filter-panel">
        <div class="filter-container">
            <div class="filter-group">
                <label class="filter-label">Vendor:</label>
                <div class="filter-select-wrapper">
                    <select class="filter-select" id="vendorFilter">
                        <option value="all">All Vendors</option>
                        <option value="vendor1">Vendor A - Tech Solutions</option>
                        <option value="vendor2">Vendor B - Cloud Services</option>
                        <option value="vendor3">Vendor C - Network Systems</option>
                        <option value="vendor4">Vendor D - Support Services</option>
                        <option value="vendor5">Vendor E - Infrastructure</option>
                    </select>
                </div>
            </div>
            <div class="filter-group">
                <label class="filter-label">Time Period:</label>
                <div class="filter-select-wrapper">
                    <select class="filter-select" id="timePeriodFilter">
                        <option value="today">Today</option>
                        <option value="yesterday">Yesterday</option>
                        <option value="7days" selected>Last 7 Days</option>
                        <option value="30days">Last 30 Days</option>
                        <option value="60days">Last 2 Months</option>
                        <option value="90days">Last 3 Months</option>
                        <option value="mtd">Month to Date</option>
                        <option value="qtd">Quarter to Date</option>
                        <option value="ytd">Year to Date</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- Vendor Details Panel -->
    <section class="vendor-details-panel">
        <div class="vendor-details-header" id="vendorDetailsHeader">Vendor Performance Details</div>
        
        <table class="vendor-table">
            <thead>
                <tr>
                    <th>Vendor</th>
                    <th>Agents Impacted</th>
                    <th>Total Calls</th>
                    <th>Disconnected</th>
                    <th>Degraded</th>
                    <th>Trend vs Previous Period</th>
                </tr>
            </thead>
            <tbody>
                <!-- Vendor 1 -->
                <tr>
                    <td>
                        <div class="vendor-table-logo">
                            <div class="vendor-table-logo-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                VA
                            </div>
                            <div class="vendor-table-info">
                                <div class="vendor-table-name">Vendor A - Tech Solutions</div>
                                <div class="vendor-table-category">Cloud Infrastructure & Services</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">28.5%</div>
                        <div class="vendor-table-subtext">2,487 agents</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">1,247</div>
                        <div class="vendor-table-subtext">Total volume</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">245</div>
                        <div class="vendor-table-subtext">Calls lost</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">647</div>
                        <div class="vendor-table-subtext">Quality issues</div>
                    </td>
                    <td>
                        <div class="vendor-table-trend trend-up">
                            <span>↑</span>
                            +18.2%
                        </div>
                        <div class="vendor-table-comparison">Last 7 Days vs Previous 7 Days</div>
                    </td>
                </tr>

                <!-- Vendor 2 -->
                <tr>
                    <td>
                        <div class="vendor-table-logo">
                            <div class="vendor-table-logo-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                VB
                            </div>
                            <div class="vendor-table-info">
                                <div class="vendor-table-name">Vendor B - Cloud Services</div>
                                <div class="vendor-table-category">Platform & Communication</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">19.3%</div>
                        <div class="vendor-table-subtext">1,685 agents</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">847</div>
                        <div class="vendor-table-subtext">Total volume</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">156</div>
                        <div class="vendor-table-subtext">Calls lost</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">467</div>
                        <div class="vendor-table-subtext">Quality issues</div>
                    </td>
                    <td>
                        <div class="vendor-table-trend trend-down">
                            <span>↓</span>
                            -8.5%
                        </div>
                        <div class="vendor-table-comparison">Last 7 Days vs Previous 7 Days</div>
                    </td>
                </tr>

                <!-- Vendor 3 -->
                <tr>
                    <td>
                        <div class="vendor-table-logo">
                            <div class="vendor-table-logo-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                VC
                            </div>
                            <div class="vendor-table-info">
                                <div class="vendor-table-name">Vendor C - Network Systems</div>
                                <div class="vendor-table-category">Network Infrastructure</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">15.7%</div>
                        <div class="vendor-table-subtext">1,372 agents</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">564</div>
                        <div class="vendor-table-subtext">Total volume</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">98</div>
                        <div class="vendor-table-subtext">Calls lost</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">300</div>
                        <div class="vendor-table-subtext">Quality issues</div>
                    </td>
                    <td>
                        <div class="vendor-table-trend trend-up">
                            <span>↑</span>
                            +5.3%
                        </div>
                        <div class="vendor-table-comparison">Last 7 Days vs Previous 7 Days</div>
                    </td>
                </tr>

                <!-- Vendor 4 -->
                <tr>
                    <td>
                        <div class="vendor-table-logo">
                            <div class="vendor-table-logo-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                VD
                            </div>
                            <div class="vendor-table-info">
                                <div class="vendor-table-name">Vendor D - Support Services</div>
                                <div class="vendor-table-category">Technical Support & Maintenance</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">12.4%</div>
                        <div class="vendor-table-subtext">1,083 agents</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">423</div>
                        <div class="vendor-table-subtext">Total volume</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">67</div>
                        <div class="vendor-table-subtext">Calls lost</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">220</div>
                        <div class="vendor-table-subtext">Quality issues</div>
                    </td>
                    <td>
                        <div class="vendor-table-trend trend-down">
                            <span>↓</span>
                            -12.1%
                        </div>
                        <div class="vendor-table-comparison">Last 7 Days vs Previous 7 Days</div>
                    </td>
                </tr>

                <!-- Vendor 5 -->
                <tr>
                    <td>
                        <div class="vendor-table-logo">
                            <div class="vendor-table-logo-icon" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                                VE
                            </div>
                            <div class="vendor-table-info">
                                <div class="vendor-table-name">Vendor E - Infrastructure</div>
                                <div class="vendor-table-category">Data Center & Hardware</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">8.9%</div>
                        <div class="vendor-table-subtext">778 agents</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">289</div>
                        <div class="vendor-table-subtext">Total volume</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">45</div>
                        <div class="vendor-table-subtext">Calls lost</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">153</div>
                        <div class="vendor-table-subtext">Quality issues</div>
                    </td>
                    <td>
                        <div class="vendor-table-trend trend-neutral">
                            <span>→</span>
                            -0.2%
                        </div>
                        <div class="vendor-table-comparison">Last 7 Days vs Previous 7 Days</div>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Trend Graphs Section -->
    <section class="trend-graphs-section">
        <div class="trend-graph-card">
            <div class="trend-graph-header">% of Agents Impacted</div>
            <div class="chart-container">
                <canvas id="agentsImpactedChart" class="chart-canvas"></canvas>
            </div>
        </div>

        <div class="trend-graph-card">
            <div class="trend-graph-header">Calls Impacted (Disconnected & Degraded)</div>
            <div class="chart-container">
                <canvas id="callsImpactedChart" class="chart-canvas"></canvas>
            </div>
            <div class="legend-container">
                <div class="legend-item">
                    <div class="legend-color" style="background: #dc2626;"></div>
                    <span>Disconnected Calls</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #f59e0b;"></div>
                    <span>Degraded Calls</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="dashboard-footer">
        <div class="footer-content">
            <div class="footer-copyright">
                © 2024 VendorScope. All rights reserved.
            </div>
            <div class="footer-divider">|</div>
            <div class="footer-support">
                For support, contact: <a href="mailto:support@vendorscope.com" class="footer-link">support@vendorscope.com</a>
            </div>
        </div>
    </footer>

    <script>
        // Vendor data structure with different time periods
        const vendorData = {
            'all': {
                'today': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '31.2%', agentsCount: '2,724', totalCalls: '1,356', disconnected: '267', degraded: '701', trend: '+22.5%', trendClass: 'trend-up', comparison: 'Today vs Yesterday' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '21.4%', agentsCount: '1,867', totalCalls: '923', disconnected: '178', degraded: '512', trend: '-5.2%', trendClass: 'trend-down', comparison: 'Today vs Yesterday' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '17.3%', agentsCount: '1,512', totalCalls: '612', disconnected: '112', degraded: '328', trend: '+7.8%', trendClass: 'trend-up', comparison: 'Today vs Yesterday' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agentsPercent: '14.1%', agentsCount: '1,231', totalCalls: '467', disconnected: '78', degraded: '245', trend: '-9.3%', trendClass: 'trend-down', comparison: 'Today vs Yesterday' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '9.8%', agentsCount: '856', totalCalls: '312', disconnected: '52', degraded: '167', trend: '+1.2%', trendClass: 'trend-up', comparison: 'Today vs Yesterday' }
                ],
                'yesterday': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '29.8%', agentsCount: '2,601', totalCalls: '1,289', disconnected: '253', degraded: '668', trend: '+19.3%', trendClass: 'trend-up', comparison: 'Yesterday vs Previous Day' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '20.6%', agentsCount: '1,799', totalCalls: '887', disconnected: '172', degraded: '491', trend: '-6.1%', trendClass: 'trend-down', comparison: 'Yesterday vs Previous Day' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '16.5%', agentsCount: '1,442', totalCalls: '584', disconnected: '107', degraded: '312', trend: '+6.4%', trendClass: 'trend-up', comparison: 'Yesterday vs Previous Day' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agentsPercent: '13.2%', agentsCount: '1,152', totalCalls: '441', disconnected: '73', degraded: '231', trend: '-10.7%', trendClass: 'trend-down', comparison: 'Yesterday vs Previous Day' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '9.3%', agentsCount: '812', totalCalls: '295', disconnected: '49', degraded: '158', trend: '+0.5%', trendClass: 'trend-neutral', comparison: 'Yesterday vs Previous Day' }
                ],
                '7days': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '28.5%', agentsCount: '2,487', totalCalls: '1,247', disconnected: '245', degraded: '647', trend: '+18.2%', trendClass: 'trend-up', comparison: 'Last 7 Days vs Previous 7 Days' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '19.3%', agentsCount: '1,685', totalCalls: '847', disconnected: '156', degraded: '467', trend: '-8.5%', trendClass: 'trend-down', comparison: 'Last 7 Days vs Previous 7 Days' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '15.7%', agentsCount: '1,372', totalCalls: '564', disconnected: '98', degraded: '300', trend: '+5.3%', trendClass: 'trend-up', comparison: 'Last 7 Days vs Previous 7 Days' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agentsPercent: '12.4%', agentsCount: '1,083', totalCalls: '423', disconnected: '67', degraded: '220', trend: '-12.1%', trendClass: 'trend-down', comparison: 'Last 7 Days vs Previous 7 Days' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '8.9%', agentsCount: '778', totalCalls: '289', disconnected: '45', degraded: '153', trend: '-0.2%', trendClass: 'trend-neutral', comparison: 'Last 7 Days vs Previous 7 Days' }
                ],
                '30days': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '26.8%', agentsCount: '2,339', totalCalls: '5,234', disconnected: '1,023', degraded: '2,756', trend: '+15.7%', trendClass: 'trend-up', comparison: 'Last 30 Days vs Previous 30 Days' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '18.2%', agentsCount: '1,589', totalCalls: '3,567', disconnected: '645', degraded: '1,978', trend: '-10.3%', trendClass: 'trend-down', comparison: 'Last 30 Days vs Previous 30 Days' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '14.9%', agentsCount: '1,301', totalCalls: '2,389', disconnected: '412', degraded: '1,267', trend: '+3.8%', trendClass: 'trend-up', comparison: 'Last 30 Days vs Previous 30 Days' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agensPercent: '11.7%', agentsCount: '1,022', totalCalls: '1,789', disconnected: '289', degraded: '934', trend: '-14.5%', trendClass: 'trend-down', comparison: 'Last 30 Days vs Previous 30 Days' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '8.4%', agentsCount: '734', totalCalls: '1,234', disconnected: '189', degraded: '645', trend: '+2.1%', trendClass: 'trend-up', comparison: 'Last 30 Days vs Previous 30 Days' }
                ],
                '60days': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '25.9%', agentsCount: '2,260', totalCalls: '10,245', disconnected: '2,012', degraded: '5,398', trend: '+14.2%', trendClass: 'trend-up', comparison: 'Last 2 Months vs Previous 2 Months' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '17.5%', agentsCount: '1,528', totalCalls: '6,987', disconnected: '1,267', degraded: '3,876', trend: '-11.8%', trendClass: 'trend-down', comparison: 'Last 2 Months vs Previous 2 Months' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '14.3%', agentsCount: '1,249', totalCalls: '4,678', disconnected: '809', degraded: '2,481', trend: '+2.9%', trendClass: 'trend-up', comparison: 'Last 2 Months vs Previous 2 Months' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agentsPercent: '11.2%', agentsCount: '978', totalCalls: '3,501', disconnected: '567', degraded: '1,829', trend: '-15.9%', trendClass: 'trend-down', comparison: 'Last 2 Months vs Previous 2 Months' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '8.1%', agentsCount: '707', totalCalls: '2,417', disconnected: '370', degraded: '1,264', trend: '+1.8%', trendClass: 'trend-up', comparison: 'Last 2 Months vs Previous 2 Months' }
                ],
                '90days': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '25.1%', agentsCount: '2,190', totalCalls: '15,012', disconnected: '2,945', degraded: '7,906', trend: '+13.5%', trendClass: 'trend-up', comparison: 'Last 3 Months vs Previous 3 Months' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '16.9%', agentsCount: '1,475', totalCalls: '10,245', disconnected: '1,856', degraded: '5,681', trend: '-12.7%', trendClass: 'trend-down', comparison: 'Last 3 Months vs Previous 3 Months' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '13.8%', agentsCount: '1,204', totalCalls: '6,867', disconnected: '1,186', degraded: '3,638', trend: '+2.1%', trendClass: 'trend-up', comparison: 'Last 3 Months vs Previous 3 Months' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agentsPercent: '10.8%', agentsCount: '942', totalCalls: '5,134', disconnected: '831', degraded: '2,681', trend: '-16.8%', trendClass: 'trend-down', comparison: 'Last 3 Months vs Previous 3 Months' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '7.8%', agentsCount: '681', totalCalls: '3,545', disconnected: '542', degraded: '1,853', trend: '+1.5%', trendClass: 'trend-up', comparison: 'Last 3 Months vs Previous 3 Months' }
                ],
                'mtd': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '27.3%', agentsCount: '2,383', totalCalls: '3,456', disconnected: '678', degraded: '1,823', trend: '+16.8%', trendClass: 'trend-up', comparison: 'MTD vs Previous MTD' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '18.6%', agentsCount: '1,624', totalCalls: '2,356', disconnected: '427', degraded: '1,308', trend: '-9.7%', trendClass: 'trend-down', comparison: 'MTD vs Previous MTD' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '15.2%', agentsCount: '1,327', totalCalls: '1,578', disconnected: '273', degraded: '838', trend: '+4.3%', trendClass: 'trend-up', comparison: 'MTD vs Previous MTD' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agentsPercent: '11.9%', agentsCount: '1,039', totalCalls: '1,182', disconnected: '191', degraded: '618', trend: '-13.9%', trendClass: 'trend-down', comparison: 'MTD vs Previous MTD' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '8.6%', agentsCount: '751', totalCalls: '815', disconnected: '125', degraded: '427', trend: '+2.4%', trendClass: 'trend-up', comparison: 'MTD vs Previous MTD' }
                ],
                'qtd': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '24.7%', agentsCount: '2,155', totalCalls: '18,567', disconnected: '3,645', degraded: '9,784', trend: '+12.9%', trendClass: 'trend-up', comparison: 'QTD vs Previous QTD' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '16.4%', agentsCount: '1,431', totalCalls: '12,678', disconnected: '2,297', degraded: '7,033', trend: '-13.5%', trendClass: 'trend-down', comparison: 'QTD vs Previous QTD' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '13.4%', agentsCount: '1,170', totalCalls: '8,501', disconnected: '1,468', degraded: '4,504', trend: '+1.6%', trendClass: 'trend-up', comparison: 'QTD vs Previous QTD' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agentsPercent: '10.5%', agentsCount: '916', totalCalls: '6,356', disconnected: '1,028', degraded: '3,319', trend: '-17.4%', trendClass: 'trend-down', comparison: 'QTD vs Previous QTD' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '7.6%', agentsCount: '663', totalCalls: '4,389', disconnected: '671', degraded: '2,295', trend: '+1.2%', trendClass: 'trend-up', comparison: 'QTD vs Previous QTD' }
                ],
                'ytd': [
                    { id: 'VA', name: 'Vendor A - Tech Solutions', category: 'Cloud Infrastructure & Services', gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', agentsPercent: '24.3%', agentsCount: '2,120', totalCalls: '72,456', disconnected: '14,218', degraded: '38,184', trend: '+12.1%', trendClass: 'trend-up', comparison: 'YTD vs Previous YTD' },
                    { id: 'VB', name: 'Vendor B - Cloud Services', category: 'Platform & Communication', gradient: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', agentsPercent: '16.1%', agentsCount: '1,405', totalCalls: '49,456', disconnected: '8,967', degraded: '27,449', trend: '-14.2%', trendClass: 'trend-down', comparison: 'YTD vs Previous YTD' },
                    { id: 'VC', name: 'Vendor C - Network Systems', category: 'Network Infrastructure', gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', agentsPercent: '13.2%', agentsCount: '1,152', totalCalls: '33,178', disconnected: '5,731', degraded: '17,589', trend: '+1.3%', trendClass: 'trend-up', comparison: 'YTD vs Previous YTD' },
                    { id: 'VD', name: 'Vendor D - Support Services', category: 'Technical Support & Maintenance', gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)', agentsPercent: '10.3%', agentsCount: '899', totalCalls: '24,823', disconnected: '4,015', degraded: '12,968', trend: '-18.1%', trendClass: 'trend-down', comparison: 'YTD vs Previous YTD' },
                    { id: 'VE', name: 'Vendor E - Infrastructure', category: 'Data Center & Hardware', gradient: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)', agentsPercent: '7.4%', agentsCount: '646', totalCells: '17,145', disconnected: '2,621', degraded: '8,963', trend: '+0.9%', trendClass: 'trend-neutral', comparison: 'YTD vs Previous YTD' }
                ]
            }
        };

        // Individual vendor data for specific vendor selection
        vendorData['vendor1'] = {
            '7days': [vendorData.all['7days'][0]],
            'today': [vendorData.all['today'][0]],
            '30days': [vendorData.all['30days'][0]],
            'yesterday': [vendorData.all['yesterday'][0]],
            '60days': [vendorData.all['60days'][0]],
            '90days': [vendorData.all['90days'][0]],
            'mtd': [vendorData.all['mtd'][0]],
            'qtd': [vendorData.all['qtd'][0]],
            'ytd': [vendorData.all['ytd'][0]]
        };
        vendorData['vendor2'] = {
            '7days': [vendorData.all['7days'][1]],
            'today': [vendorData.all['today'][1]],
            '30days': [vendorData.all['30days'][1]],
            'yesterday': [vendorData.all['yesterday'][1]],
            '60days': [vendorData.all['60days'][1]],
            '90days': [vendorData.all['90days'][1]],
            'mtd': [vendorData.all['mtd'][1]],
            'qtd': [vendorData.all['qtd'][1]],
            'ytd': [vendorData.all['ytd'][1]]
        };
        vendorData['vendor3'] = {
            '7days': [vendorData.all['7days'][2]],
            'today': [vendorData.all['today'][2]],
            '30days': [vendorData.all['30days'][2]],
            'yesterday': [vendorData.all['yesterday'][2]],
            '60days': [vendorData.all['60days'][2]],
            '90days': [vendorData.all['90days'][2]],
            'mtd': [vendorData.all['mtd'][2]],
            'qtd': [vendorData.all['qtd'][2]],
            'ytd': [vendorData.all['ytd'][2]]
        };
        vendorData['vendor4'] = {
            '7days': [vendorData.all['7days'][3]],
            'today': [vendorData.all['today'][3]],
            '30days': [vendorData.all['30days'][3]],
            'yesterday': [vendorData.all['yesterday'][3]],
            '60days': [vendorData.all['60days'][3]],
            '90days': [vendorData.all['90days'][3]],
            'mtd': [vendorData.all['mtd'][3]],
            'qtd': [vendorData.all['qtd'][3]],
            'ytd': [vendorData.all['ytd'][3]]
        };
        vendorData['vendor5'] = {
            '7days': [vendorData.all['7days'][4]],
            'today': [vendorData.all['today'][4]],
            '30days': [vendorData.all['30days'][4]],
            'yesterday': [vendorData.all['yesterday'][4]],
            '60days': [vendorData.all['60days'][4]],
            '90days': [vendorData.all['90days'][4]],
            'mtd': [vendorData.all['mtd'][4]],
            'qtd': [vendorData.all['qtd'][4]],
            'ytd': [vendorData.all['ytd'][4]]
        };

        // Function to update header title based on dropdown values
        function updateHeaderTitle(vendor, timePeriod) {
            const vendorNames = {
                'all': 'All Vendors',
                'vendor1': 'Vendor A - Tech Solutions',
                'vendor2': 'Vendor B - Cloud Services',
                'vendor3': 'Vendor C - Network Systems',
                'vendor4': 'Vendor D - Support Services',
                'vendor5': 'Vendor E - Infrastructure'
            };
            
            const periodNames = {
                'today': 'Today',
                'yesterday': 'Yesterday',
                '7days': 'Last 7 Days',
                '30days': 'Last 30 Days',
                '60days': 'Last 2 Months',
                '90days': 'Last 3 Months',
                'mtd': 'Month to Date',
                'qtd': 'Quarter to Date',
                'ytd': 'Year to Date'
            };
            
            const vendorName = vendorNames[vendor] || 'All Vendors';
            const periodName = periodNames[timePeriod] || 'Last 7 Days';
            
            const headerElement = document.getElementById('vendorDetailsHeader');
            if (headerElement) {
                headerElement.textContent = `${vendorName} Performance - ${periodName}`;
            }
        }

        // Function to generate comparison label with actual dates
        function getComparisonLabel(timePeriod) {
            const today = new Date();
            const formatDate = (date) => {
                const month = date.toLocaleString('en-US', { month: 'short' });
                const day = date.getDate();
                return `${month} ${day}`;
            };
            
            const formatMonthYear = (date) => {
                return date.toLocaleString('en-US', { month: 'short', year: 'numeric' });
            };
            
            switch(timePeriod) {
                case 'today': {
                    const yesterday = new Date(today);
                    yesterday.setDate(yesterday.getDate() - 1);
                    return `${formatDate(today)} vs ${formatDate(yesterday)}`;
                }
                
                case 'yesterday': {
                    const yesterday = new Date(today);
                    yesterday.setDate(yesterday.getDate() - 1);
                    const dayBefore = new Date(today);
                    dayBefore.setDate(dayBefore.getDate() - 2);
                    return `${formatDate(yesterday)} vs ${formatDate(dayBefore)}`;
                }
                
                case '7days': {
                    const weekStart = new Date(today);
                    weekStart.setDate(weekStart.getDate() - 6);
                    const prevWeekStart = new Date(today);
                    prevWeekStart.setDate(prevWeekStart.getDate() - 13);
                    const prevWeekEnd = new Date(today);
                    prevWeekEnd.setDate(prevWeekEnd.getDate() - 7);
                    return `${formatDate(weekStart)} - ${formatDate(today)} vs ${formatDate(prevWeekStart)} - ${formatDate(prevWeekEnd)}`;
                }
                
                case '30days': {
                    const monthStart = new Date(today);
                    monthStart.setDate(monthStart.getDate() - 29);
                    const prevMonthStart = new Date(today);
                    prevMonthStart.setDate(prevMonthStart.getDate() - 59);
                    const prevMonthEnd = new Date(today);
                    prevMonthEnd.setDate(prevMonthEnd.getDate() - 30);
                    return `${formatDate(monthStart)} - ${formatDate(today)} vs ${formatDate(prevMonthStart)} - ${formatDate(prevMonthEnd)}`;
                }
                
                case '60days': {
                    const start = new Date(today);
                    start.setDate(start.getDate() - 59);
                    const prevStart = new Date(today);
                    prevStart.setDate(prevStart.getDate() - 119);
                    const prevEnd = new Date(today);
                    prevEnd.setDate(prevEnd.getDate() - 60);
                    return `${formatDate(start)} - ${formatDate(today)} vs ${formatDate(prevStart)} - ${formatDate(prevEnd)}`;
                }
                
                case '90days': {
                    const currentMonth = new Date(today);
                    const twoMonthsAgo = new Date(today);
                    twoMonthsAgo.setMonth(twoMonthsAgo.getMonth() - 2);
                    const fiveMonthsAgo = new Date(today);
                    fiveMonthsAgo.setMonth(fiveMonthsAgo.getMonth() - 5);
                    const threeMonthsAgo = new Date(today);
                    threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);
                    return `${formatMonthYear(twoMonthsAgo)} - ${formatMonthYear(currentMonth)} vs ${formatMonthYear(fiveMonthsAgo)} - ${formatMonthYear(threeMonthsAgo)}`;
                }
                
                case 'mtd': {
                    const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
                    const prevMonthStart = new Date(today.getFullYear(), today.getMonth() - 1, 1);
                    const prevMonthSameDay = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
                    return `${formatMonthYear(monthStart)} (1 - ${today.getDate()}) vs ${formatMonthYear(prevMonthStart)} (1 - ${today.getDate()})`;
                }
                
                case 'qtd': {
                    const quarter = Math.floor(today.getMonth() / 3);
                    const quarterStart = new Date(today.getFullYear(), quarter * 3, 1);
                    const prevQuarterStart = new Date(today.getFullYear(), (quarter - 1) * 3, 1);
                    const quarterName = ['Q1', 'Q2', 'Q3', 'Q4'][quarter];
                    const prevQuarterName = ['Q4', 'Q1', 'Q2', 'Q3'][quarter];
                    const prevYear = quarter === 0 ? today.getFullYear() - 1 : today.getFullYear();
                    return `${quarterName} ${today.getFullYear()} vs ${prevQuarterName} ${prevYear}`;
                }
                
                case 'ytd': {
                    const yearStart = new Date(today.getFullYear(), 0, 1);
                    const prevYearStart = new Date(today.getFullYear() - 1, 0, 1);
                    return `${today.getFullYear()} vs ${today.getFullYear() - 1}`;
                }
                
                default:
                    return 'Current Period vs Previous Period';
            }
        }

        // Function to update the vendor table
        function updateVendorTable() {
            const vendorFilter = document.getElementById('vendorFilter').value;
            const timePeriodFilter = document.getElementById('timePeriodFilter').value;
            
            // Update header title
            updateHeaderTitle(vendorFilter, timePeriodFilter);
            
            // Get appropriate data
            const selectedVendor = vendorFilter;
            const selectedPeriod = timePeriodFilter;
            
            // Use the selected period directly, defaulting to '7days' if not found
            const period = selectedPeriod || '7days';
            
            // Get data from vendorData or fall back to 'all' vendor with the same period
            const data = vendorData[selectedVendor]?.[period] || vendorData['all'][period] || vendorData['all']['7days'];
            
            // Get dynamic comparison label
            const comparisonLabel = getComparisonLabel(selectedPeriod);
            
            // Update table body
            const tbody = document.querySelector('.vendor-table tbody');
            tbody.innerHTML = '';
            
            data.forEach(vendor => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div class="vendor-table-logo">
                            <div class="vendor-table-logo-icon" style="background: ${vendor.gradient};">
                                ${vendor.id}
                            </div>
                            <div class="vendor-table-info">
                                <div class="vendor-table-name">${vendor.name}</div>
                                <div class="vendor-table-category">${vendor.category}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">${vendor.agentsPercent}</div>
                        <div class="vendor-table-subtext">${vendor.agentsCount} agents</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">${vendor.totalCalls}</div>
                        <div class="vendor-table-subtext">Total volume</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">${vendor.disconnected}</div>
                        <div class="vendor-table-subtext">Calls lost</div>
                    </td>
                    <td>
                        <div class="vendor-table-metric">${vendor.degraded}</div>
                        <div class="vendor-table-subtext">Quality issues</div>
                    </td>
                    <td>
                        <div class="vendor-table-trend ${vendor.trendClass}">
                            <span>${vendor.trend.startsWith('+') ? '↑' : vendor.trend.startsWith('-') ? '↓' : '→'}</span>
                            ${vendor.trend}
                        </div>
                        <div class="vendor-table-comparison">${comparisonLabel}</div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Chart color scheme
        const chartColors = {
            agentsImpacted: '#2563eb',
            disconnected: '#dc2626',
            degraded: '#f59e0b',
            grid: '#e5e7eb',
            text: '#6b7280'
        };

        // Function to get X-axis labels based on time period
        function getXAxisLabels(timePeriod) {
            const today = new Date();
            const labels = [];
            
            if (timePeriod === 'today' || timePeriod === 'yesterday') {
                return ['12 AM', '4 AM', '8 AM', '12 PM', '4 PM', '8 PM', '11 PM'];
            } else if (timePeriod === '7days') {
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                }
                return labels;
            } else if (timePeriod === '30days') {
                // Show first day of each week for 7 weeks
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - (i * 7));
                    const dayOfWeek = date.getDay();
                    const diff = date.getDate() - dayOfWeek + (dayOfWeek === 0 ? -6 : 1);
                    const monday = new Date(date.setDate(diff));
                    labels.push(monday.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                }
                return labels;
            } else if (timePeriod === '60days' || timePeriod === '90days' || timePeriod === 'qtd') {
                // Show month labels
                const monthsBack = timePeriod === '60days' ? 2 : timePeriod === '90days' ? 3 : 7;
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    const weeksBack = Math.floor((monthsBack * 30) / 7);
                    date.setDate(date.getDate() - (i * Math.floor(weeksBack / 7)));
                    labels.push(date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' }));
                }
                return labels;
            } else if (timePeriod === 'mtd') {
                // Show weeks in current month
                for (let i = 0; i < 7; i++) {
                    labels.push(`Week ${i + 1}`);
                }
                return labels;
            } else if (timePeriod === 'ytd') {
                // Show months for the year
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setMonth(date.getMonth() - i);
                    labels.push(date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' }));
                }
                return labels;
            }
            
            return labels;
        }

        // Function to create line chart
        function createLineChart(canvasId, data, color, labels) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            // Set canvas dimensions
            canvas.width = canvas.offsetWidth * window.devicePixelRatio;
            canvas.height = canvas.offsetHeight * window.devicePixelRatio;
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            
            const width = canvas.offsetWidth;
            const height = canvas.offsetHeight;
            const padding = { top: 20, right: 20, bottom: 40, left: 60 };
            const chartWidth = width - padding.left - padding.right;
            const chartHeight = height - padding.top - padding.bottom;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            // Find min and max values
            const maxValue = Math.max(...data) * 1.1;
            const minValue = 0;
            
            // Draw grid lines
            ctx.strokeStyle = chartColors.grid;
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding.top + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding.left, y);
                ctx.lineTo(width - padding.right, y);
                ctx.stroke();
                
                // Y-axis labels
                const value = maxValue - (maxValue / 5) * i;
                ctx.fillStyle = chartColors.text;
                ctx.font = '11px Calibri';
                ctx.textAlign = 'right';
                ctx.fillText(value.toFixed(1) + '%', padding.left - 10, y + 4);
            }
            
            // X-axis labels
            ctx.fillStyle = chartColors.text;
            ctx.font = '11px Calibri';
            ctx.textAlign = 'center';
            for (let i = 0; i < data.length; i++) {
                const x = padding.left + (chartWidth / (data.length - 1)) * i;
                ctx.fillText(labels[i], x, height - padding.bottom + 20);
            }
            
            // Draw line
            ctx.strokeStyle = color;
            ctx.lineWidth = 3;
            ctx.lineJoin = 'round';
            ctx.lineCap = 'round';
            ctx.beginPath();
            
            data.forEach((value, index) => {
                const x = padding.left + (chartWidth / (data.length - 1)) * index;
                const y = padding.top + chartHeight - ((value - minValue) / (maxValue - minValue)) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // Draw points
            ctx.fillStyle = color;
            data.forEach((value, index) => {
                const x = padding.left + (chartWidth / (data.length - 1)) * index;
                const y = padding.top + chartHeight - ((value - minValue) / (maxValue - minValue)) * chartHeight;
                
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fill();
                
                // White center
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.arc(x, y, 2, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = color;
            });
        }

        // Function to create stacked area chart for calls
        function createStackedChart(canvasId, disconnectedData, degradedData, labels) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            // Set canvas dimensions
            canvas.width = canvas.offsetWidth * window.devicePixelRatio;
            canvas.height = canvas.offsetHeight * window.devicePixelRatio;
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            
            const width = canvas.offsetWidth;
            const height = canvas.offsetHeight;
            const padding = { top: 20, right: 20, bottom: 40, left: 60 };
            const chartWidth = width - padding.left - padding.right;
            const chartHeight = height - padding.top - padding.bottom;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            // Calculate total for each point
            const totalData = disconnectedData.map((val, idx) => val + degradedData[idx]);
            const maxValue = Math.max(...totalData) * 1.1;
            
            // Draw grid lines
            ctx.strokeStyle = chartColors.grid;
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding.top + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding.left, y);
                ctx.lineTo(width - padding.right, y);
                ctx.stroke();
                
                // Y-axis labels
                const value = maxValue - (maxValue / 5) * i;
                ctx.fillStyle = chartColors.text;
                ctx.font = '11px Calibri';
                ctx.textAlign = 'right';
                ctx.fillText(Math.round(value).toLocaleString(), padding.left - 10, y + 4);
            }
            
            // X-axis labels
            ctx.fillStyle = chartColors.text;
            ctx.font = '11px Calibri';
            ctx.textAlign = 'center';
            for (let i = 0; i < disconnectedData.length; i++) {
                const x = padding.left + (chartWidth / (disconnectedData.length - 1)) * i;
                ctx.fillText(labels[i], x, height - padding.bottom + 20);
            }
            
            // Draw degraded area (bottom)
            ctx.fillStyle = chartColors.degraded + '80'; // Add transparency
            ctx.beginPath();
            ctx.moveTo(padding.left, padding.top + chartHeight);
            
            degradedData.forEach((value, index) => {
                const x = padding.left + (chartWidth / (degradedData.length - 1)) * index;
                const y = padding.top + chartHeight - (value / maxValue) * chartHeight;
                ctx.lineTo(x, y);
            });
            
            ctx.lineTo(width - padding.right, padding.top + chartHeight);
            ctx.closePath();
            ctx.fill();
            
            // Draw disconnected area (top)
            ctx.fillStyle = chartColors.disconnected + '80'; // Add transparency
            ctx.beginPath();
            
            // Start from degraded line
            degradedData.forEach((value, index) => {
                const x = padding.left + (chartWidth / (degradedData.length - 1)) * index;
                const y = padding.top + chartHeight - (value / maxValue) * chartHeight;
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            
            // Go to total line
            for (let i = totalData.length - 1; i >= 0; i--) {
                const x = padding.left + (chartWidth / (totalData.length - 1)) * i;
                const y = padding.top + chartHeight - (totalData[i] / maxValue) * chartHeight;
                ctx.lineTo(x, y);
            }
            
            ctx.closePath();
            ctx.fill();
            
            // Draw border lines
            ctx.strokeStyle = chartColors.degraded;
            ctx.lineWidth = 2;
            ctx.beginPath();
            degradedData.forEach((value, index) => {
                const x = padding.left + (chartWidth / (degradedData.length - 1)) * index;
                const y = padding.top + chartHeight - (value / maxValue) * chartHeight;
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            ctx.strokeStyle = chartColors.disconnected;
            ctx.beginPath();
            totalData.forEach((value, index) => {
                const x = padding.left + (chartWidth / (totalData.length - 1)) * index;
                const y = padding.top + chartHeight - (value / maxValue) * chartHeight;
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
        }

        // Sample trend data for different vendors and time periods
        const trendData = {
            'all': {
                'today': {
                    agentsImpacted: [2.1, 2.3, 2.5, 2.4, 2.6, 2.5, 2.4],
                    disconnected: [850, 920, 980, 950, 1020, 980, 960],
                    degraded: [1240, 1310, 1380, 1350, 1420, 1380, 1360]
                },
                'yesterday': {
                    agentsImpacted: [2.0, 2.2, 2.4, 2.3, 2.5, 2.4, 2.3],
                    disconnected: [830, 900, 960, 930, 1000, 970, 940],
                    degraded: [1220, 1290, 1360, 1330, 1400, 1370, 1340]
                },
                '7days': {
                    agentsImpacted: [2.2, 2.4, 2.5, 2.3, 2.6, 2.5, 2.4],
                    disconnected: [890, 940, 1020, 980, 1050, 1010, 960],
                    degraded: [1280, 1350, 1440, 1400, 1480, 1430, 1360]
                },
                '30days': {
                    agentsImpacted: [2.3, 2.5, 2.6, 2.4, 2.7, 2.6, 2.5],
                    disconnected: [920, 980, 1050, 1010, 1080, 1040, 1000],
                    degraded: [1320, 1400, 1480, 1430, 1520, 1470, 1420]
                },
                '90days': {
                    agentsImpacted: [2.4, 2.6, 2.7, 2.5, 2.8, 2.7, 2.6],
                    disconnected: [950, 1020, 1090, 1050, 1120, 1080, 1040],
                    degraded: [1360, 1450, 1530, 1480, 1560, 1520, 1470]
                },
                'mtd': {
                    agentsImpacted: [2.2, 2.3, 2.4, 2.5, 2.6, 2.5, 2.4],
                    disconnected: [890, 920, 960, 1000, 1040, 1010, 960],
                    degraded: [1280, 1320, 1380, 1440, 1490, 1450, 1380]
                },
                'qtd': {
                    agentsImpacted: [2.5, 2.7, 2.8, 2.6, 2.9, 2.8, 2.7],
                    disconnected: [980, 1060, 1130, 1090, 1160, 1120, 1080],
                    degraded: [1400, 1510, 1600, 1550, 1640, 1590, 1540]
                },
                'ytd': {
                    agentsImpacted: [2.6, 2.8, 2.9, 2.7, 3.0, 2.9, 2.8],
                    disconnected: [1010, 1090, 1160, 1120, 1190, 1150, 1110],
                    degraded: [1440, 1560, 1650, 1600, 1690, 1640, 1590]
                }
            },
            'twilio': {
                'today': {
                    agentsImpacted: [1.8, 2.0, 2.2, 2.1, 2.3, 2.2, 2.1],
                    disconnected: [720, 780, 840, 810, 880, 850, 820],
                    degraded: [1050, 1120, 1180, 1150, 1220, 1180, 1160]
                },
                'yesterday': {
                    agentsImpacted: [1.7, 1.9, 2.1, 2.0, 2.2, 2.1, 2.0],
                    disconnected: [700, 760, 820, 790, 860, 830, 800],
                    degraded: [1030, 1100, 1160, 1130, 1200, 1170, 1140]
                },
                '7days': {
                    agentsImpacted: [1.9, 2.1, 2.2, 2.0, 2.3, 2.2, 2.1],
                    disconnected: [750, 820, 880, 850, 920, 890, 850],
                    degraded: [1080, 1180, 1250, 1220, 1290, 1250, 1220]
                },
                '30days': {
                    agentsImpacted: [2.0, 2.2, 2.3, 2.1, 2.4, 2.3, 2.2],
                    disconnected: [780, 850, 920, 880, 950, 920, 890],
                    degraded: [1120, 1220, 1290, 1250, 1330, 1290, 1260]
                },
                '60days': {
                    agentsImpacted: [2.05, 2.25, 2.35, 2.15, 2.45, 2.35, 2.25],
                    disconnected: [795, 865, 935, 895, 965, 935, 905],
                    degraded: [1140, 1240, 1310, 1270, 1350, 1310, 1280]
                },
                '90days': {
                    agentsImpacted: [2.1, 2.3, 2.4, 2.2, 2.5, 2.4, 2.3],
                    disconnected: [810, 880, 950, 910, 980, 950, 920],
                    degraded: [1160, 1260, 1330, 1290, 1370, 1330, 1300]
                },
                'mtd': {
                    agentsImpacted: [1.9, 2.0, 2.1, 2.2, 2.3, 2.2, 2.1],
                    disconnected: [750, 780, 820, 860, 900, 870, 840],
                    degraded: [1080, 1120, 1180, 1240, 1290, 1250, 1210]
                },
                'qtd': {
                    agentsImpacted: [2.2, 2.4, 2.5, 2.3, 2.6, 2.5, 2.4],
                    disconnected: [840, 920, 990, 950, 1020, 990, 960],
                    degraded: [1200, 1310, 1390, 1350, 1430, 1390, 1360]
                },
                'ytd': {
                    agentsImpacted: [2.3, 2.5, 2.6, 2.4, 2.7, 2.6, 2.5],
                    disconnected: [870, 950, 1020, 980, 1050, 1020, 990],
                    degraded: [1240, 1360, 1440, 1400, 1480, 1440, 1410]
                }
            },
            'bandwidth': {
                'today': {
                    agentsImpacted: [2.3, 2.5, 2.7, 2.6, 2.8, 2.7, 2.6],
                    disconnected: [950, 1020, 1100, 1050, 1130, 1100, 1070],
                    degraded: [1380, 1450, 1530, 1480, 1560, 1530, 1500]
                },
                'yesterday': {
                    agentsImpacted: [2.2, 2.4, 2.6, 2.5, 2.7, 2.6, 2.5],
                    disconnected: [930, 1000, 1080, 1030, 1110, 1080, 1050],
                    degraded: [1360, 1430, 1510, 1460, 1540, 1510, 1480]
                },
                '7days': {
                    agentsImpacted: [2.4, 2.6, 2.7, 2.5, 2.8, 2.7, 2.6],
                    disconnected: [980, 1050, 1120, 1080, 1160, 1130, 1100],
                    degraded: [1410, 1500, 1580, 1540, 1620, 1590, 1550]
                },
                '30days': {
                    agentsImpacted: [2.5, 2.7, 2.8, 2.6, 2.9, 2.8, 2.7],
                    disconnected: [1010, 1090, 1160, 1120, 1200, 1170, 1140],
                    degraded: [1450, 1550, 1630, 1590, 1670, 1640, 1600]
                },
                '60days': {
                    agentsImpacted: [2.55, 2.75, 2.85, 2.65, 2.95, 2.85, 2.75],
                    disconnected: [1025, 1105, 1175, 1135, 1215, 1185, 1155],
                    degraded: [1470, 1575, 1655, 1615, 1695, 1665, 1625]
                },
                '90days': {
                    agentsImpacted: [2.6, 2.8, 2.9, 2.7, 3.0, 2.9, 2.8],
                    disconnected: [1040, 1120, 1190, 1150, 1230, 1200, 1170],
                    degraded: [1490, 1600, 1680, 1640, 1720, 1690, 1650]
                },
                'mtd': {
                    agentsImpacted: [2.4, 2.5, 2.6, 2.7, 2.8, 2.7, 2.6],
                    disconnected: [980, 1010, 1050, 1090, 1130, 1100, 1070],
                    degraded: [1410, 1450, 1510, 1570, 1620, 1580, 1540]
                },
                'qtd': {
                    agentsImpacted: [2.7, 2.9, 3.0, 2.8, 3.1, 3.0, 2.9],
                    disconnected: [1070, 1150, 1220, 1180, 1250, 1220, 1190],
                    degraded: [1540, 1650, 1740, 1700, 1780, 1750, 1710]
                },
                'ytd': {
                    agentsImpacted: [2.8, 3.0, 3.1, 2.9, 3.2, 3.1, 3.0],
                    disconnected: [1100, 1180, 1250, 1210, 1280, 1250, 1220],
                    degraded: [1580, 1700, 1790, 1750, 1830, 1800, 1760]
                }
            },
            'vonage': {
                'today': {
                    agentsImpacted: [2.0, 2.2, 2.4, 2.3, 2.5, 2.4, 2.3],
                    disconnected: [820, 890, 960, 930, 1000, 970, 940],
                    degraded: [1190, 1260, 1330, 1300, 1370, 1340, 1310]
                },
                'yesterday': {
                    agentsImpacted: [1.9, 2.1, 2.3, 2.2, 2.4, 2.3, 2.2],
                    disconnected: [800, 870, 940, 910, 980, 950, 920],
                    degraded: [1170, 1240, 1310, 1280, 1350, 1320, 1290]
                },
                '7days': {
                    agentsImpacted: [2.1, 2.3, 2.4, 2.2, 2.5, 2.4, 2.3],
                    disconnected: [850, 920, 990, 960, 1030, 1000, 970],
                    degraded: [1220, 1300, 1370, 1340, 1410, 1380, 1350]
                },
                '30days': {
                    agentsImpacted: [2.2, 2.4, 2.5, 2.3, 2.6, 2.5, 2.4],
                    disconnected: [880, 950, 1020, 990, 1060, 1030, 1000],
                    degraded: [1260, 1350, 1420, 1390, 1460, 1430, 1400]
                },
                '90days': {
                    agentsImpacted: [2.3, 2.5, 2.6, 2.4, 2.7, 2.6, 2.5],
                    disconnected: [910, 980, 1050, 1020, 1090, 1060, 1030],
                    degraded: [1300, 1400, 1470, 1440, 1510, 1480, 1450]
                },
                'mtd': {
                    agentsImpacted: [2.1, 2.2, 2.3, 2.4, 2.5, 2.4, 2.3],
                    disconnected: [850, 880, 920, 960, 1000, 970, 940],
                    degraded: [1220, 1260, 1320, 1380, 1430, 1390, 1350]
                },
                'qtd': {
                    agentsImpacted: [2.4, 2.6, 2.7, 2.5, 2.8, 2.7, 2.6],
                    disconnected: [940, 1020, 1090, 1050, 1120, 1090, 1060],
                    degraded: [1350, 1460, 1540, 1500, 1580, 1550, 1520]
                },
                'ytd': {
                    agentsImpacted: [2.5, 2.7, 2.8, 2.6, 2.9, 2.8, 2.7],
                    disconnected: [970, 1050, 1120, 1080, 1150, 1120, 1090],
                    degraded: [1390, 1510, 1590, 1550, 1630, 1600, 1570]
                }
            },
            'plivo': {
                'today': {
                    agentsImpacted: [1.9, 2.1, 2.3, 2.2, 2.4, 2.3, 2.2],
                    disconnected: [780, 850, 920, 890, 960, 930, 900],
                    degraded: [1130, 1200, 1270, 1240, 1310, 1280, 1250]
                },
                'yesterday': {
                    agentsImpacted: [1.8, 2.0, 2.2, 2.1, 2.3, 2.2, 2.1],
                    disconnected: [760, 830, 900, 870, 940, 910, 880],
                    degraded: [1110, 1180, 1250, 1220, 1290, 1260, 1230]
                },
                '7days': {
                    agentsImpacted: [2.0, 2.2, 2.3, 2.1, 2.4, 2.3, 2.2],
                    disconnected: [810, 880, 950, 920, 990, 960, 930],
                    degraded: [1160, 1240, 1310, 1280, 1350, 1320, 1290]
                },
                '30days': {
                    agentsImpacted: [2.1, 2.3, 2.4, 2.2, 2.5, 2.4, 2.3],
                    disconnected: [840, 910, 980, 950, 1020, 990, 960],
                    degraded: [1200, 1290, 1360, 1330, 1400, 1370, 1340]
                },
                '60days': {
                    agentsImpacted: [2.15, 2.35, 2.45, 2.25, 2.55, 2.45, 2.35],
                    disconnected: [855, 925, 995, 965, 1035, 1005, 975],
                    degraded: [1220, 1315, 1385, 1355, 1425, 1395, 1365]
                },
                '90days': {
                    agentsImpacted: [2.2, 2.4, 2.5, 2.3, 2.6, 2.5, 2.4],
                    disconnected: [870, 940, 1010, 980, 1050, 1020, 990],
                    degraded: [1240, 1340, 1410, 1380, 1450, 1420, 1390]
                },
                'mtd': {
                    agentsImpacted: [2.0, 2.1, 2.2, 2.3, 2.4, 2.3, 2.2],
                    disconnected: [810, 840, 880, 920, 960, 930, 900],
                    degraded: [1160, 1200, 1260, 1320, 1370, 1330, 1290]
                },
                'qtd': {
                    agentsImpacted: [2.3, 2.5, 2.6, 2.4, 2.7, 2.6, 2.5],
                    disconnected: [900, 980, 1050, 1010, 1080, 1050, 1020],
                    degraded: [1290, 1400, 1480, 1440, 1520, 1490, 1460]
                },
                'ytd': {
                    agentsImpacted: [2.4, 2.6, 2.7, 2.5, 2.8, 2.7, 2.6],
                    disconnected: [930, 1010, 1080, 1040, 1110, 1080, 1050],
                    degraded: [1330, 1450, 1530, 1490, 1570, 1540, 1510]
                }
            },
            'telnyx': {
                'today': {
                    agentsImpacted: [2.2, 2.4, 2.6, 2.5, 2.7, 2.6, 2.5],
                    disconnected: [900, 970, 1040, 1010, 1080, 1050, 1020],
                    degraded: [1310, 1380, 1450, 1420, 1490, 1460, 1430]
                },
                'yesterday': {
                    agentsImpacted: [2.1, 2.3, 2.5, 2.4, 2.6, 2.5, 2.4],
                    disconnected: [880, 950, 1020, 990, 1060, 1030, 1000],
                    degraded: [1290, 1360, 1430, 1400, 1470, 1440, 1410]
                },
                '7days': {
                    agentsImpacted: [2.3, 2.5, 2.6, 2.4, 2.7, 2.6, 2.5],
                    disconnected: [930, 1000, 1070, 1040, 1110, 1080, 1050],
                    degraded: [1340, 1420, 1490, 1460, 1530, 1500, 1470]
                },
                '30days': {
                    agentsImpacted: [2.4, 2.6, 2.7, 2.5, 2.8, 2.7, 2.6],
                    disconnected: [960, 1030, 1100, 1070, 1140, 1110, 1080],
                    degraded: [1380, 1470, 1540, 1510, 1580, 1550, 1520]
                },
                '60days': {
                    agentsImpacted: [2.45, 2.65, 2.75, 2.55, 2.85, 2.75, 2.65],
                    disconnected: [975, 1045, 1115, 1085, 1155, 1125, 1095],
                    degraded: [1400, 1495, 1565, 1535, 1605, 1575, 1545]
                },
                '90days': {
                    agentsImpacted: [2.5, 2.7, 2.8, 2.6, 2.9, 2.8, 2.7],
                    disconnected: [990, 1060, 1130, 1100, 1170, 1140, 1110],
                    degraded: [1420, 1520, 1590, 1560, 1630, 1600, 1570]
                },
                'mtd': {
                    agentsImpacted: [2.3, 2.4, 2.5, 2.6, 2.7, 2.6, 2.5],
                    disconnected: [930, 960, 1000, 1040, 1080, 1050, 1020],
                    degraded: [1340, 1380, 1440, 1500, 1550, 1510, 1470]
                },
                'qtd': {
                    agentsImpacted: [2.6, 2.8, 2.9, 2.7, 3.0, 2.9, 2.8],
                    disconnected: [1020, 1100, 1170, 1130, 1200, 1170, 1140],
                    degraded: [1470, 1580, 1660, 1620, 1700, 1670, 1640]
                },
                'ytd': {
                    agentsImpacted: [2.7, 2.9, 3.0, 2.8, 3.1, 3.0, 2.9],
                    disconnected: [1050, 1130, 1200, 1160, 1230, 1200, 1170],
                    degraded: [1510, 1630, 1710, 1670, 1750, 1720, 1690]
                }
            }
        };

        // Function to update charts based on vendor and time period
        function updateCharts() {
            const vendorFilter = document.getElementById('vendorFilter').value;
            const timePeriod = document.getElementById('timePeriodFilter').value;
            
            // Get data for selected vendor and time period
            const data = trendData[vendorFilter][timePeriod];
            
            // Get appropriate X-axis labels
            const labels = getXAxisLabels(timePeriod);
            
            if (data) {
                // Create/update charts
                createLineChart('agentsImpactedChart', data.agentsImpacted, chartColors.agentsImpacted, labels);
                createStackedChart('callsImpactedChart', data.disconnected, data.degraded, labels);
            }
        }

        // Add event listeners to dropdowns
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize with default values
            updateVendorTable();
            updateCharts();
            
            // Add change listeners
            document.getElementById('vendorFilter').addEventListener('change', function() {
                updateVendorTable();
                updateCharts();
            });
            document.getElementById('timePeriodFilter').addEventListener('change', function() {
                updateVendorTable();
                updateCharts();
            });
            
            // Initialize dashboard
            updateTimestamp();
            initializeControls();
            
            // Update timestamp every minute
            setInterval(updateTimestamp, 60000);
            
            // Simulate real-time data updates every 30 seconds
            setInterval(updateMetrics, 30000);
            
            // Redraw charts on window resize
            window.addEventListener('resize', function() {
                updateCharts();
            });
        });

        function updateTimestamp() {
            const now = new Date();
            const timestamp = now.toLocaleString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Update timestamp in header
            const timestampElement = document.querySelector('.last-updated-executive span');
            if (timestampElement) {
                timestampElement.textContent = `Live Data • Last updated: ${timestamp}`;
            }
        }

        function initializeControls() {
            // Add event listeners to controls
            const controls = document.querySelectorAll('.executive-select');
            controls.forEach(control => {
                control.addEventListener('change', function() {
                    handleControlChange(this);
                });
            });
        }

        function handleControlChange(control) {
            // Add visual feedback
            control.style.borderColor = '#3182ce';
            setTimeout(() => {
                control.style.borderColor = '#e2e8f0';
            }, 1000);
            
            // In a real application, this would trigger data refresh
            console.log(`Filter changed: ${control.id} = ${control.value}`);
            
            // Show loading state briefly
            showLoadingState();
        }

        function showLoadingState() {
            const cards = document.querySelectorAll('.executive-card, .vendor-card');
            cards.forEach(card => {
                card.style.opacity = '0.7';
            });
            
            setTimeout(() => {
                cards.forEach(card => {
                    card.style.opacity = '1';
                });
            }, 800);
        }

        function updateMetrics() {
            // Simulate slight metric changes (in real app, this would come from API)
            const metrics = [
                { id: 'serviceRisk', range: [22.5, 24.9] },
                { id: 'callSuccess', range: [86.8, 87.6] },
                { id: 'vendorHealth', value: Math.random() > 0.7 ? '3 of 5' : '2 of 5' }
            ];
            
            // Add subtle animation to show data refresh
            const metricValues = document.querySelectorAll('.metric-value');
            metricValues.forEach(element => {
                element.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    element.style.transform = 'scale(1)';
                }, 200);
            });
        }

        function exportReport() {
            // Simulate export functionality
            const btn = document.querySelector('.export-btn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = `
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,4V2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6A6,6 0 0,1 18,12Z"/>
                </svg>
                Exporting...
            `;
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/>
                    </svg>
                    Export Complete
                `;
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
            }, 1500);
        }

        // Alert banner management
        function dismissAlert() {
            const banner = document.getElementById('alertBanner');
            if (banner) {
                banner.style.transform = 'translateY(-100%)';
                setTimeout(() => {
                    banner.style.display = 'none';
                }, 300);
            }
        }

        // Keyboard shortcuts for executives
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'e':
                        e.preventDefault();
                        exportReport();
                        break;
                    case 'r':
                        e.preventDefault();
                        location.reload();
                        break;
                }
            }
        });

        // Performance monitoring
        const performanceObserver = new PerformanceObserver((list) => {
            for (const entry of list.getEntries()) {
                if (entry.entryType === 'navigation') {
                    console.log(`Dashboard loaded in ${Math.round(entry.loadEventEnd - entry.loadEventStart)}ms`);
                }
            }
        });
        performanceObserver.observe({ entryTypes: ['navigation'] });
    </script>
</body>
</html>